# 福利彩票购买平台 - 项目介绍文档

**双端移动应用系统 - 技术文档**

---

## 📋 项目概述

这是一个完整的福利彩票购买平台,包含**店主端(Keeper)**和**用户端(User)**两个独立的移动应用。平台支持多种彩票类型的投注、合买、出票、兑奖等完整业务流程,采用React Native + Expo技术栈开发,支持iOS、Android和Web三端部署。

### 项目统计

| 指标 | 数量 |
|------|------|
| 应用端 | 2个 |
| 彩票类型 | 9+ |
| API接口 | 50+ |
| 平台支持 | 3个(iOS/Android/Web) |

---

## 🔄 双端应用对比

### 店主端 (Keeper)

**版本:** v1.1.0  
**面向:** 彩票店主

**核心功能:**
- ✅ **票务管理** - 方案审核、出票、兑奖
- ✅ **账本系统** - 账户流水、充值、提现
- ✅ **推广功能** - 代理管理、佣金结算
- ✅ **合作店铺** - 跨店合作、资金管理
- ✅ **统计报表** - 销售数据、收益分析
- ✅ **用户管理** - 客户信息、消费记录

**底部导航:**
- 票务 (Ticket)
- 账本 (Account)
- 推广 (Proxy)
- 我的 (Profile)

---

### 用户端 (User)

**版本:** v1.2.1  
**面向:** 彩票购买者

**核心功能:**
- ✅ **彩票选购** - 多种彩票类型选号投注
- ✅ **比分查询** - 竞彩足球实时比分
- ✅ **店铺选择** - 切换投注店铺
- ✅ **历史记录** - 投注历史、中奖记录
- ✅ **合买功能** - 发起/参与合买
- ✅ **账户管理** - 余额、充值、提现

**底部导航:**
- 首页 (Home)
- 比分 (Score)
- 店铺 (Store)
- 记录 (History)
- 我的 (Profile)

---

## 🏗️ 技术架构

### 四层架构

```
┌─────────────────────────────────────────────────┐
│  📱 展示层 (Presentation Layer)                  │
│  React Native + Expo | React Navigation         │
│  React Native Paper                              │
└─────────────────────────────────────────────────┘
                      ↓
┌─────────────────────────────────────────────────┐
│  🔧 业务逻辑层 (Business Logic Layer)            │
│  Hooks (ahooks) | Context API | AsyncStorage    │
└─────────────────────────────────────────────────┘
                      ↓
┌─────────────────────────────────────────────────┐
│  🌐 数据访问层 (Data Access Layer)               │
│  Axios | RESTful API | 请求拦截器               │
└─────────────────────────────────────────────────┘
                      ↓
┌─────────────────────────────────────────────────┐
│  ☁️ 后端服务 (Backend Services)                  │
│  API Server (8.218.147.24:8080)                 │
│  Payment Service                                 │
└─────────────────────────────────────────────────┘
```

### 核心技术栈

| 技术领域 | 技术选型 |
|---------|---------|
| **框架** | React Native 0.71-0.72 |
| **开发平台** | Expo SDK 48 |
| **导航** | React Navigation 6 |
| **UI组件** | React Native Paper |
| **UI库** | Ant Design RN |
| **状态管理** | Context API + Hooks |
| **网络请求** | Axios |
| **数据持久化** | AsyncStorage |
| **Hooks工具** | ahooks |
| **表单管理** | React Hook Form |
| **图表** | React Native Chart Kit |
| **语言** | TypeScript |

---

## ⚙️ 核心功能模块

### 🎯 支持的彩票类型

1. **双色球 (SSQ)**
2. **福彩3D (F3D)**
3. **七乐彩 (X7C)**
4. **任选九 (RX9)**
5. **胜负彩 (SFC)**
6. **足彩 (ZJC)**
7. **排列3 (PL3)**
8. **排列5 (PL5)**
9. **大乐透 (DLT)**

---

### 📱 用户端核心流程

#### 1️⃣ 选择店铺
用户可以选择不同的彩票店进行投注,支持代理链接绑定

#### 2️⃣ 选号投注
支持多种彩票类型的选号方式,包括直选、组选、复式等

#### 3️⃣ 提交订单
可选择单独购买或发起合买,支持保存方案和倍数设置

#### 4️⃣ 支付结算
使用账户余额支付,支持充值和提现功能

#### 5️⃣ 等待出票
店主审核并出票,用户可查看票据图片

---

### 🏪 店主端核心流程

#### 1️⃣ 接收订单
实时接收用户提交的投注订单,支持筛选和搜索

#### 2️⃣ 审核订单
检查订单内容,可接受或拒绝订单,支持转单功能

#### 3️⃣ 出票上传
打印彩票后拍照上传票据图片

#### 4️⃣ 结算收款
订单完成后进行结算,资金进入店铺账户

#### 5️⃣ 兑奖处理
中奖后处理兑奖流程,支付奖金给用户

---

## 🔌 API接口架构

### 🔐 认证授权
- `sendCode` - 发送验证码
- `login` - 手机号登录
- `loginByPassword` - 密码登录
- `fetchAuthStatus` - 认证状态

### 🎫 订单管理
- `fetchOrders` - 获取订单列表
- `fetchOrderDetail` - 订单详情
- `acceptOrder` - 接受订单
- `rejectOrder` - 拒绝订单
- `ticketOrder` - 出票
- `switchOrder` - 转单
- `deleteOrder` - 取消订单

### 🤝 合买管理
- `fetchOrderGroups` - 合买列表
- `fetchOrderGroupDetail` - 合买详情
- `addGroupOrder` - 发起合买
- `addOrderGroupOrder` - 参与合买
- `fetchOrderGroupOrders` - 合买份额

### 📝 方案管理
- `addPlan` - 保存方案
- `fetchPlans` - 方案列表
- `deletePlans` - 删除方案
- `fetchCurrentIssue` - 当前期号

### 💰 支付系统
- `pay` - 创建支付
- `addTopUpOrder` - 充值
- `addWithdrawOrder` - 提现
- `fetchUserAccount` - 账户信息
- `fetchAccounts` - 账户流水
- `fetchPayMethods` - 支付方式

### 🏪 店铺管理
- `fetchStoreInfo` - 店铺信息
- `fetchMyStore` - 我的店铺
- `updateStore` - 更新店铺
- `updateStoreItems` - 彩种设置
- `updateStoreNotice` - 公告设置

### 👥 代理系统
- `fetchProxies` - 代理列表
- `addProxy` - 添加代理
- `fetchProxyUsers` - 代理用户
- `fetchProxyRewards` - 代理佣金
- `payProxyReward` - 佣金结算

### 🤝 合作店铺
- `fetchCoStores` - 合作列表
- `addCoStore` - 添加合作
- `updateCoStore` - 更新合作
- `pauseCoStore` / `resumeCoStore` - 暂停/恢复
- `addCoStoreTopUp` - 合作充值

### ⚽ 比分数据
- `fetchMatches` - 比赛列表
- `fetchMatchFilters` - 比赛筛选
- `fetchItemStates` - 彩种状态

### 📸 文件上传
- `uploadImage` - 图片上传
- `uploadImageV2` - Base64上传

---

## 📁 代码结构

### 店主端目录结构

```
keeper/
├── src/
│   ├── assets/          # 静态资源
│   ├── components/      # 通用组件
│   │   ├── AmountView/  # 金额显示
│   │   ├── Ball/        # 彩球组件
│   │   ├── Ticket/      # 票据组件
│   │   ├── ListView/    # 列表组件
│   │   └── ...
│   ├── screens/         # 页面组件
│   │   ├── Ticket/      # 票务管理
│   │   ├── Account/     # 账本
│   │   ├── Proxy/       # 推广
│   │   ├── Order/       # 订单
│   │   ├── OrderGroup/  # 合买
│   │   ├── Cooperation/ # 合作店铺
│   │   ├── Stats/       # 统计
│   │   └── Profile/     # 我的
│   ├── service/         # API服务
│   │   ├── api.ts       # 接口定义
│   │   └── typs.d.ts    # 类型定义
│   ├── hooks/           # 自定义Hooks
│   │   ├── auth.ts      # 认证
│   │   ├── counters.ts  # 计数器
│   │   └── ...
│   ├── providers/       # Context提供者
│   │   ├── global.tsx   # 全局状态
│   │   ├── theme.tsx    # 主题
│   │   └── splash.tsx   # 启动屏
│   ├── triggers/        # 触发器组件
│   └── utils/           # 工具函数
├── config.ts            # 配置文件
└── package.json         # 依赖配置
```

### 用户端目录结构

```
user/
├── src/
│   ├── assets/          # 静态资源
│   ├── components/      # 通用组件
│   │   ├── Ball/        # 彩球组件
│   │   ├── Layout/      # 布局组件
│   │   ├── ListView/    # 列表组件
│   │   └── ...
│   ├── screens/         # 页面组件
│   │   ├── Home/        # 首页
│   │   ├── Store/       # 店铺
│   │   ├── Match/       # 比分
│   │   ├── History/     # 记录
│   │   ├── Plan/        # 方案编辑
│   │   │   └── Editor/  # 各彩种编辑器
│   │   │       ├── Ssq/     # 双色球
│   │   │       ├── F3d/     # 福彩3D
│   │   │       ├── Dlt/     # 大乐透
│   │   │       ├── Pl5/     # 排列5
│   │   │       ├── X7c/     # 七乐彩
│   │   │       └── Zc/      # 足彩
│   │   ├── Order/       # 订单
│   │   ├── OrderGroup/  # 合买
│   │   └── Profile/     # 我的
│   ├── service/         # API服务
│   ├── hooks/           # 自定义Hooks
│   │   ├── auth.ts      # 认证
│   │   ├── store.ts     # 店铺
│   │   ├── item.ts      # 彩种
│   │   └── storage.ts   # 存储
│   ├── providers/       # Context提供者
│   ├── triggers/        # 触发器组件
│   └── utils/           # 工具函数
├── config.ts            # 配置文件
└── package.json         # 依赖配置
```

### 关键组件说明

| 组件 | 说明 |
|------|------|
| `main.tsx` | 应用入口,导航配置 |
| `providers/global.tsx` | 全局状态管理 |
| `service/api.ts` | API接口封装 |
| `hooks/auth.ts` | 认证状态管理 |
| `components/ListView` | 列表通用组件 |
| `triggers/` | 业务触发器组件 |

---

## ✨ 特色功能

### 🎯 智能选号
- 支持多种选号方式(直选、组选、复式)
- 实时计算注数和金额
- 方案保存和历史记录
- 倍数设置和追号功能

### 🤝 合买系统
- 发起合买设置份额和佣金
- 参与合买实时更新进度
- 合买详情查看参与者
- 自动分配中奖奖金

### 💳 支付系统
- 账户余额支付
- 在线充值提现
- 交易流水查询
- 多种支付方式

### 📊 数据统计
- 销售数据图表展示
- 收益分析报表
- 用户消费统计
- 代理佣金统计

### 🔔 实时通知
- 订单状态变更通知
- 出票完成提醒
- 中奖消息推送
- 系统公告提示

### 🏪 店铺管理
- 店铺信息设置
- 彩种开关控制
- 公告发布管理
- 合作店铺功能

---

## 💡 技术亮点

### 🚀 跨平台开发
采用React Native + Expo技术栈,一套代码同时支持iOS、Android和Web三个平台,大幅提高开发效率,降低维护成本。使用Expo提供的原生模块,无需编写原生代码即可实现复杂功能。

### 🔧 模块化架构
- **组件复用** - 通用组件库,提高开发效率
- **Hooks封装** - 业务逻辑抽象,代码更清晰
- **Context管理** - 全局状态统一管理
- **API封装** - 统一的请求拦截和错误处理

### 🎨 用户体验优化
- **Material Design** - 遵循Material Design设计规范
- **骨架屏加载** - 优化加载体验
- **下拉刷新** - 数据实时更新
- **倒计时组件** - 实时显示截止时间
- **图片预览** - 支持票据图片放大查看

### 🔒 安全性设计
- **Token认证** - Bearer Token身份验证
- **请求拦截** - 统一添加认证头
- **错误处理** - 全局错误拦截和提示
- **权限控制** - 基于角色的功能访问控制

---

## 🚀 部署配置

### 环境配置

| 环境 | 地址 |
|------|------|
| **开发环境** | localhost:8080 |
| **测试环境** | i.staging.easeme.cn |
| **生产环境** | 8.218.147.24:8080 |

### 构建命令

```bash
# 开发模式
npm run dev

# 测试环境
npm run test

# 生产环境
npm run prod

# Web构建
npm run build:web:production

# Android构建
eas build --profile production --platform android

# iOS构建
eas build --profile production --platform ios
```

---

## 📌 项目总结

这是一个**功能完善、架构清晰**的福利彩票购买平台。通过React Native技术实现跨平台开发,采用模块化设计提高代码复用性和可维护性。

### 核心优势

✅ **完整业务流程** - 覆盖选号、投注、出票、兑奖全流程  
✅ **跨平台支持** - iOS、Android、Web三端统一  
✅ **模块化架构** - 组件复用,易于维护和扩展  
✅ **商业级应用** - 支持多店铺、代理、合作等复杂业务

### 技术特点

- **双端应用分工明确** - 店主端专注订单处理和店铺管理,用户端提供便捷投注体验
- **支持多种彩票类型** - 9+种彩票玩法,满足不同用户需求
- **完善的支付系统** - 充值、提现、账户流水完整闭环
- **灵活的代理推广** - 支持多级代理和佣金结算

---

**文档生成时间:** 2025-11-28  
**项目路径:** /Users/tongxu/Projects/meepod/mobile/shop  
**应用版本:** Keeper v1.1.0 | User v1.2.1
